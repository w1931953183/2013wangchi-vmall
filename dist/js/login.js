var valnum,valpass,valurl,se=window.location.search,arrse=se.split("="),reg=/^http:\W{2}localhost/;const usernum=document.querySelector("[name=loginuesr]"),userpass=document.querySelector("[name=loginpass]");0<se.length?reg.test(arrse[1])?valurl=arrse[1]+"="+arrse[2].toString().split("&")[0]:(valnum=se.split("=")[1].toString().split("&")[0],valpass=se.split("=")[2],usernum.value=valnum,userpass.value=valpass):(valnum=usernum.value,valpass=userpass.value);const sublogin=document.querySelector("[name=sublogin]");btnCss(),usernum.addEventListener("input",btnCss),userpass.addEventListener("input",btnCss),sublogin.addEventListener("click",function(){!async function(){var e=await promiseAjax({url:"../php/login.php",data:`val1=${valnum}&val2=${valpass}`,datatype:"json",type:"post"});if(!(0<e.length))return alert("登录失败请检查您的账号密码");reg.test(arrse[1])?(setCookie(valnum,e[0].username),window.location.href=valurl+"&user="+valnum):(setCookie(valnum,e[0].username),alert("登录成功，点击跳转到首页"),window.location.href="./index.html?val="+valnum)}()});const have=document.querySelector(".login-have"),nothave=document.querySelector(".login-not");function btnCss(){valnum=usernum.value,valpass=userpass.value,1<valnum.length&&1<valpass.length?(sublogin.style.backgroundColor="#CA141D",sublogin.style.cursor="pointer"):(sublogin.style.backgroundColor="#FF989C",sublogin.style.cursor="not-allowed")}have.addEventListener("click",function(){this.style.display="none",nothave.style.display="inline-block",userpass.setAttribute("type","text")}),nothave.addEventListener("click",function(){this.style.display="none",have.style.display="inline-block",userpass.setAttribute("type","password")});